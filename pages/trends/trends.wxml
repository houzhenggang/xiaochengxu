<!--pages/trends/trends.wxml-->
<view>
  <view class='item_box' wx:for='{{trendsData}}' wx:key='{{index}}'>

    <view class='box_header'>
      <image src='{{image + logo_url}}'></image>
      <view class='user_info'>
        <text>{{name}}</text>
        <text>{{item.time_stamp}}</text>
      </view>
    </view>

    <view class='box_content'>
      <view data-id='{{item.id}}' catchtap='commentDetail'>
        <view class='{{item.type == 1 ? "content_text" : "content_text title"}}'>{{item.type == 1 ? item.content : item.title}}</view>
        <view class='image' wx:if='{{item.type == 2 && item.cover_url}}'>
          <image src='{{image + item.cover_url}}' data-index='{{index}}' catchtap='viewImage' mode='aspectFill'></image>
        </view>
        <view class='images' wx:if='{{item.type == 1}}'>
          <image wx:for='{{item.images}}' class='{{item.images.length == 1 ? "one" : (item.images.length == 2 ? "two" : "more")}}' wx:for-item='ite' wx:for-index='ind' src='{{image + ite.img_url}}?imageView2/1/w/222/h/222' wx:key='{{ind}}' mode='{{item.images.length > 2 ? aspectFit : widthFix}}' data-index='{{index}}' data-ind='{{ind}}' catchtap='viewImages'></image>
        </view>
      </view>
      <view class='stati_data'>
        <view class='stati_left'>
          <view><image src='../../imgs/Browse_icon@2x.png'></image><text>{{item.pv_browse}}</text></view>
          <view bindtap='commentVisi' data-id='{{item.id}}'>
            <image src='../../imgs/Comment_icon@2x.png'></image><text>{{item.pv_share}}</text>
          </view>
        </view>
        <view  wx:if='{{item.vote}}' data-id='{{item.id}}' data-index="{{index}}" bindtap='cancledVote'><image src='../../imgs/Zan_gary_red@2x.png'></image><text>{{item.pv_vote}}</text></view> 
        <view bindtap='vote' data-id='{{item.id}}' data-index="{{index}}" wx:else><image src='../../imgs/Zan_gary_icon@2x.png'></image><text>{{item.pv_vote}}</text></view>
      </view>

      <view wx:if='{{item.comments.length}}' class='comments'>
        <block wx:for='{{item.comments}}' wx:for-item='ite' wx:for-index='ind' wx:key='{{ind}}'>
          <view wx:if='{{ite.type == 1}}'><text>{{ite.nick_name}} : </text>{{ite.content}}</view>
          <view wx:else><text>{{name}}</text><text>回复</text><text>{{ite.nick_name}} : </text> {{ite.content}}</view>          
        </block>
        <view class='comments_count' wx:if='{{item.comment_success_count > 10}}'>共{{item.comment_success_count}}条回复></view>
      </view>
    </view>
  </view>
  <view class='bottom' wx:if='{{trendsData.length}}'>到底啦，去别处逛逛吧</view>
</view>
<view class='input_outer' wx:if='{{inputVisi}}'>
      <input bindinput='userInput' bindblur='userBlur' placeholder='{{"回复" + name}}' auto-focus='{{autoFocus}}' bindconfirm='comment'></input>
      <text class='{{value ? "active" : ""}}' bindtap='comment'>发送</text>  
  </view>